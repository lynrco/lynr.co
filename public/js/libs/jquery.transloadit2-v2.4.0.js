/*
 jQuery Easing v1.3: Copyright (c) 2008 George McGinley Smith | BSD License: http://www.opensource.org/licenses/bsd-license.php
 jquery.transloadit2-v2.4.0.js: Copyright (c) 2013 Transloadit Ltd | MIT License: http://www.opensource.org/licenses/mit-license.php

 Fork this on Github: http://github.com/transloadit/jquery-sdk

 Transloadit servers allow browsers to cache jquery.transloadit2.js for 1 hour.
 keep this in mind when rolling out fixes.
 json2: Douglas Crockford | Public domain
 jQuery Tools 1.2.3: Tero Piirainen | Public domain
*/
jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,a,f,b,c){return jQuery.easing[jQuery.easing.def](e,a,f,b,c)},easeInQuad:function(e,a,f,b,c){return b*(a/=c)*a+f},easeOutQuad:function(e,a,f,b,c){return-b*(a/=c)*(a-2)+f},easeInOutQuad:function(e,a,f,b,c){return 1>(a/=c/2)?b/2*a*a+f:-b/2*(--a*(a-2)-1)+f},easeInCubic:function(e,a,f,b,c){return b*(a/=c)*a*a+f},easeOutCubic:function(e,a,f,b,c){return b*((a=a/c-1)*a*a+1)+f},easeInOutCubic:function(e,a,f,b,c){return 1>(a/=c/2)?b/2*a*a*a+f:
b/2*((a-=2)*a*a+2)+f},easeInQuart:function(e,a,f,b,c){return b*(a/=c)*a*a*a+f},easeOutQuart:function(e,a,f,b,c){return-b*((a=a/c-1)*a*a*a-1)+f},easeInOutQuart:function(e,a,f,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+f:-b/2*((a-=2)*a*a*a-2)+f},easeInQuint:function(e,a,f,b,c){return b*(a/=c)*a*a*a*a+f},easeOutQuint:function(e,a,f,b,c){return b*((a=a/c-1)*a*a*a*a+1)+f},easeInOutQuint:function(e,a,f,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+f:b/2*((a-=2)*a*a*a*a+2)+f},easeInSine:function(e,a,f,b,c){return-b*Math.cos(a/
c*(Math.PI/2))+b+f},easeOutSine:function(e,a,f,b,c){return b*Math.sin(a/c*(Math.PI/2))+f},easeInOutSine:function(e,a,f,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+f},easeInExpo:function(e,a,f,b,c){return 0==a?f:b*Math.pow(2,10*(a/c-1))+f},easeOutExpo:function(e,a,f,b,c){return a==c?f+b:b*(-Math.pow(2,-10*a/c)+1)+f},easeInOutExpo:function(e,a,f,b,c){return 0==a?f:a==c?f+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+f:b/2*(-Math.pow(2,-10*--a)+2)+f},easeInCirc:function(e,a,f,b,c){return-b*(Math.sqrt(1-(a/=c)*
a)-1)+f},easeOutCirc:function(e,a,f,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+f},easeInOutCirc:function(e,a,f,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+f:b/2*(Math.sqrt(1-(a-=2)*a)+1)+f},easeInElastic:function(e,a,f,b,c){e=1.70158;var g=0,h=b;if(0==a)return f;if(1==(a/=c))return f+b;g||(g=0.3*c);h<Math.abs(b)?(h=b,e=g/4):e=g/(2*Math.PI)*Math.asin(b/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*c-e)*Math.PI/g))+f},easeOutElastic:function(e,a,f,b,c){e=1.70158;var g=0,h=b;if(0==a)return f;if(1==
(a/=c))return f+b;g||(g=0.3*c);h<Math.abs(b)?(h=b,e=g/4):e=g/(2*Math.PI)*Math.asin(b/h);return h*Math.pow(2,-10*a)*Math.sin(2*(a*c-e)*Math.PI/g)+b+f},easeInOutElastic:function(e,a,f,b,c){e=1.70158;var g=0,h=b;if(0==a)return f;if(2==(a/=c/2))return f+b;g||(g=0.3*c*1.5);h<Math.abs(b)?(h=b,e=g/4):e=g/(2*Math.PI)*Math.asin(b/h);return 1>a?-0.5*h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*c-e)*Math.PI/g)+f:h*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*c-e)*Math.PI/g)*0.5+b+f},easeInBack:function(e,a,f,b,c,g){void 0==
g&&(g=1.70158);return b*(a/=c)*a*((g+1)*a-g)+f},easeOutBack:function(e,a,f,b,c,g){void 0==g&&(g=1.70158);return b*((a=a/c-1)*a*((g+1)*a+g)+1)+f},easeInOutBack:function(e,a,f,b,c,g){void 0==g&&(g=1.70158);return 1>(a/=c/2)?b/2*a*a*(((g*=1.525)+1)*a-g)+f:b/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+f},easeInBounce:function(e,a,f,b,c){return b-jQuery.easing.easeOutBounce(e,c-a,0,b,c)+f},easeOutBounce:function(e,a,f,b,c){return(a/=c)<1/2.75?7.5625*b*a*a+f:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+f:a<2.5/2.75?
b*(7.5625*(a-=2.25/2.75)*a+0.9375)+f:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+f},easeInOutBounce:function(e,a,f,b,c){return a<c/2?0.5*jQuery.easing.easeInBounce(e,2*a,0,b,c)+f:0.5*jQuery.easing.easeOutBounce(e,2*a-c,0,b,c)+0.5*b+f}});
(function(e){function a(){}function f(a){E=[a]}function b(a,d,h){return a&&a.apply(d.context||d,h)}function c(c){function K(a){z++||(A(),B&&(G[r]={s:[a]}),L&&(a=L.apply(c,[a])),b(H,c,[a,M,c]),b(N,c,[c,M]))}function F(a){z++||(A(),B&&a!=O&&(G[r]=a),b(I,c,[c,a]),b(N,c,[c,a]))}c=e.extend({},P,c);var H=c.success,I=c.error,N=c.complete,L=c.dataFilter,C=c.callbackParameter,Q=c.callback,X=c.cache,B=c.pageCache,R=c.charset,r=c.url,w=c.data,S=c.timeout,D,z=0,A=a,p,x,J;T&&T(function(a){a.done(H).fail(I);H=
a.resolve;I=a.reject}).promise(c);c.abort=function(){!z++&&A()};if(!1===b(c.beforeSend,c,[c])||z)return c;r=r||d;w=w?"string"==typeof w?w:e.param(w,c.traditional):d;r+=w?(/\?/.test(r)?"&":"?")+w:d;C&&(r+=(/\?/.test(r)?"&":"?")+encodeURIComponent(C)+"=?");X||B||(r+=(/\?/.test(r)?"&":"?")+"_"+(new Date).getTime()+"=");r=r.replace(/=\?(&|$)/,"="+Q+"$1");B&&(D=G[r])?D.s?K(D.s[0]):F(D):(U[Q]=f,p=e(l)[0],p.id=t+Y++,R&&(p[h]=R),V&&11.6>V.version()?(x=e(l)[0]).text="document.getElementById('"+p.id+"')."+
k+"()":p[g]=g,Z&&(p.htmlFor=p.id,p.event=v),p[q]=p[k]=p[u]=function(a){if(!p[m]||!/i/.test(p[m])){try{p[v]&&p[v]()}catch(d){}a=E;E=0;a?K(a[0]):F(s)}},p.src=r,A=function(a){J&&clearTimeout(J);p[u]=p[q]=p[k]=null;y[n](p);x&&y[n](x)},y[W](p,C=y.firstChild),x&&y[W](x,C),J=0<S&&setTimeout(function(){F(O)},S));return c}var g="async",h="charset",d="",s="error",W="insertBefore",t="_jqjsp",v="onclick",k="on"+s,q="onload",u="onreadystatechange",m="readyState",n="removeChild",l="<script>",M="success",O="timeout",
U=window,T=e.Deferred,y=e("head")[0]||document.documentElement,G={},Y=0,E,P={callback:t,url:location.href},V=U.opera,Z=!!e("<div>").html("\x3c!--[if IE]><i><![endif]--\x3e").find("i").length;c.setup=function(a){e.extend(P,a)};e.jsonp=c})(jQuery);this.JSON||(this.JSON={});
(function(){function e(a){return 10>a?"0"+a:a}function a(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var h=d[a];return"string"===typeof h?h:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(d,c){var e,b,q,u,m=g,n,l=c[d];l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(d));"function"===typeof s&&(l=s.call(c,d,l));switch(typeof l){case "string":return a(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);
case "object":if(!l)return"null";g+=h;n=[];if("[object Array]"===Object.prototype.toString.apply(l)){u=l.length;for(e=0;e<u;e+=1)n[e]=f(e,l)||"null";q=0===n.length?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+m+"]":"["+n.join(",")+"]";g=m;return q}if(s&&"object"===typeof s)for(u=s.length,e=0;e<u;e+=1)b=s[e],"string"===typeof b&&(q=f(b,l))&&n.push(a(b)+(g?": ":":")+q);else for(b in l)Object.hasOwnProperty.call(l,b)&&(q=f(b,l))&&n.push(a(b)+(g?": ":":")+q);q=0===n.length?"{}":g?"{\n"+g+n.join(",\n"+g)+"\n"+
m+"}":"{"+n.join(",")+"}";g=m;return q}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},s;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,d,c){var e;h=g="";if("number"===typeof c)for(e=0;e<c;e+=1)h+=" ";else"string"===typeof c&&(h=c);if((s=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return f("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,d){function h(a,c){var e,b,f=a[c];if(f&&"object"===typeof f)for(e in f)Object.hasOwnProperty.call(f,e)&&(b=h(f,e),void 0!==b?f[e]=b:delete f[e]);return d.call(a,c,f)}var c;a=String(a);b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),"function"===typeof d?h({"":c},""):c;throw new SyntaxError("JSON.parse");})})();
(function(e){e.tools=e.tools||{version:"2013-02-15"};var a=e.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff"}},f,b,c,g,h;e.mask={load:function(d,s){if(c)return this;d=d||g;g=d=e.extend(e.extend({},a.conf),d);f=e("#"+d.maskId);f.length||(f=e("<div/>").attr("id",d.maskId),e("body").append(f));f.css({position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"none",opacity:d.startOpacity,zIndex:d.zIndex,backgroundColor:d.color});
s&&s.length&&(h=s.eq(0).css("zIndex"),b=s.css({zIndex:Math.max(d.zIndex+1,"auto"==h?0:h)}));f.css({display:"block"}).fadeTo(d.loadSpeed,d.opacity);c=!0;return this},close:function(){c&&(f.fadeOut(g.closeSpeed,function(){b&&b.css({zIndex:h})}),c=!1);return this}};e.fn.mask=function(a){e.mask.load(a);return this};e.fn.expose=function(a){e.mask.load(a,this);return this}})(jQuery);
!function(e){function a(){this.timer=this.documentTitle=this.instance=this.assemblyId=null;this._options={};this.uploads=[];this.results={};this.pollStarted=this.ended=null;this.seq=this.pollRetries=0;this.started=!1;this.params=this.assembly=null;this.lastPoll=this.bytesReceivedBefore=0;this.$modal=this.$iframe=this.$fileClones=this.$files=this.$form=this.$params=null;this._clockseq=this._lastNSecs=this._lastMSecs=0}var f="https:"==document.location.protocol?"https://":"http://",b=f+"api2.transloadit.com/",
c={service:b,assets:f+"assets.transloadit.com/",onFileSelect:function(){},onStart:function(){},onProgress:function(){},onUpload:function(){},onResult:function(){},onCancel:function(){},onError:function(){},onSuccess:function(){},interval:2500,pollTimeout:8E3,poll404Retries:15,pollConnectionRetries:3,wait:!1,processZeroFiles:!0,triggerUploadOnFileSelection:!1,autoSubmit:!0,modal:!0,exclude:"",fields:!1,params:null,signature:null,region:"us-east-1",debug:!0},g=!1;e.fn.transloadit=function(){var h=Array.prototype.slice.call(arguments),
d,c;if(0!==this.length)if(1<this.length)this.each(function(){e.fn.transloadit.apply(e(this),h)});else{(1==h.length&&"object"==typeof h[0]||void 0===h[0])&&h.unshift("init");d=h.shift();"init"==d?(c=new a,h.unshift(this),this.data("transloadit.uploader",c)):c=this.data("transloadit.uploader");if(!c)throw Error("Element is not initialized for transloadit!");d=c[d].apply(c,h);return void 0===d?this:d}};a.prototype.init=function(a,d){this.$form=a;this.options(e.extend({},c,d||{}));var b=this;a.bind("submit.transloadit",
function(){b.validate();b.detectFileInputs();b._options.processZeroFiles||0!==b.$files.length?b.getBoredInstance():b.submitForm();return!1});if(this._options.triggerUploadOnFileSelection)a.on("change",'input[type="file"]',function(){a.trigger("submit.transloadit")});a.on("change",'input[type="file"]',function(){b._options.onFileSelect(e(this).val(),e(this))});this.includeCss()};a.prototype.getBoredInstance=function(){function a(){e.jsonp({url:c,timeout:d._options.pollTimeout,callbackParameter:"callback",
success:function(a){a.error?(d.ended=!0,a.url=c,d.renderError(a),d._options.onError(a)):(d.instance=a.api2_host,d.start())},error:function(e,v){if(g&&d._options.service===b&&"https://"!==f)g=!1,d._findBoredInstanceUrl(function(e,b){e?(d.ended=!0,e={error:"BORED_INSTANCE_ERROR",message:"Could not find a bored instance. "+e.message},d.renderError(e),d._options.onError(e)):(c=f+"api2."+b+"/instances/bored",a())});else{d.ended=!0;var k={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",
reason:"JSONP request status: "+v,url:c};d.renderError(k);d._options.onError(k)}}})}var d=this;this.instance=null;var c=this._options.service+"instances/bored",g=!0;a();this._options.modal&&this.showModal()};a.prototype._findBoredInstanceUrl=function(a){var d=this;e.ajax({url:"http://infra-"+this._options.region+".transloadit.com.s3.amazonaws.com/cached_instances.json",datatype:"json",timeout:3E3,success:function(c){c=d._shuffle(c.uploaders);d._findResponsiveInstance(c,0,a)},error:function(d,c){a(Error("Could not query S3 for cached uploaders"))}})};
a.prototype._findResponsiveInstance=function(a,d,c){if(!a[d])return c(Error("No responsive uploaders"));var b=this,t=a[d];e.jsonp({url:f+t,timeout:3E3,callbackParameter:"callback",success:function(a){c(null,t)},error:function(e,f){b._findResponsiveInstance(a,d+1,c)}})};a.prototype._shuffle=function(a){for(var d=[],c,e=0;e<a.length;e++)c=Math.floor(Math.random()*(e+1)),d[e]=d[c],d[c]=a[e];return d};a.prototype.start=function(){var a=this;this.ended=this.started=!1;this.seq=this.pollRetries=this.bytesReceivedBefore=
0;this.uploads=[];this.results={};this.assemblyId=this._genUuid();this.$fileClones=e().not(document);this.$files.each(function(){var d=e(this).clone(!0);a.$fileClones=a.$fileClones.add(d);d.insertAfter(this)});this.$iframe=e('<iframe id="transloadit-'+this.assemblyId+'" name="transloadit-'+this.assemblyId+'"/>').appendTo("body").hide();var d=f+this.instance+"/assemblies/"+this.assemblyId+"?redirect=false";if(this._options.formData){this._options.formData.append("params",this.$form.find("input[name=params]").val());
var c=new XMLHttpRequest;c.open("POST",d);c.send(this._options.formData)}else{this.$uploadForm=e('<form enctype="multipart/form-data" />').attr("action",d).attr("target","transloadit-"+this.assemblyId).attr("method","POST").append(this.$files).appendTo("body").hide();d="[name=params], [name=signature]";!0===this._options.fields?d="*":"string"===typeof this._options.fields&&(d+=", "+this._options.fields);var b=this.$form.find(":input[type!=file]").filter(d),d=b.filter("select"),b=b.filter(function(){return!e(this).is("select")}),
b=b.filter("[type!=submit]"),b=this.clone(b);this._options.params&&!this.$params&&(b=b.add('<input name="params" value=\''+JSON.stringify(this._options.params)+"'>"));this._options.signature&&(b=b.add('<input name="signature" value=\''+this._options.signature+"'>"));if("object"==typeof this._options.fields)for(c in this._options.fields)b=b.add('<input name="'+c+"\" value='"+this._options.fields[c]+"'>");b.prependTo(this.$uploadForm);d.each(function(){e('<input type="hidden"/>').attr("name",e(this).attr("name")).attr("value",
e(this).val()).prependTo(a.$uploadForm)});this.$uploadForm.submit()}this.lastPoll=+new Date;setTimeout(function(){a._poll()},300)};a.prototype.clone=function(a){var d=a.clone();a=a.filter("textarea");for(var c=d.filter("textarea"),b=0;b<a.length;++b)e(c[b]).val(e(a[b]).val());return d};a.prototype.detectFileInputs=function(){var a=this.$form.find("input[type=file]").not(this._options.exclude);this._options.processZeroFiles||(a=a.filter(function(){return""!==this.value}));this.$files=a};a.prototype.validate=
function(){if(this._options.params)this.params=this._options.params;else{var a=this.$form.find("input[name=params]");if(!a.length){alert("Could not find input[name=params] in your form.");return}this.$params=a;try{this.params=JSON.parse(a.val())}catch(d){alert("Error: input[name=params] seems to contain invalid JSON.");return}}this.params.redirect_url?this.$form.attr("action",this.params.redirect_url):this._options.autoSubmit&&this.$form.attr("action")==this._options.service+"assemblies"&&alert("Error: input[name=params] does not include a redirect_url")};
a.prototype._poll=function(a){var d=this;if(!this.ended){var c=/(mozilla)(?:.*? rv:([\w.]+))?/.exec(navigator.userAgent),c=c&&c[1];this.documentTitle=document.title;c&&!this.documentTitle&&(document.title="Loading...");this.pollStarted=+new Date;var c=this.instance.replace(/\.transloadit\.com/,"")+"-status.transloadit.com",b=f+c+"/assemblies/"+this.assemblyId+(a||"?seq="+this.seq);e.jsonp({url:b,timeout:d._options.pollTimeout,callbackParameter:"callback",success:function(a){if(!d.ended)if(d.assembly=
a,"ASSEMBLY_NOT_FOUND"==a.error)d.pollRetries++,d.pollRetries>d._options.poll404Retries?(document.title=d.documentTitle,d.ended=!0,d.renderError(a),d._options.onError(a)):setTimeout(function(){d._poll()},400);else if(a.error)d.ended=!0,d.renderError(a),document.title=d.documentTitle,d._options.onError(a);else{d.seq=a.last_seq;d.started||(d.started=!0,d._options.onStart(a));d.pollRetries=0;var c="ASSEMBLY_EXECUTING"===a.ok,b="ASSEMBLY_CANCELED"===a.ok,e="ASSEMBLY_COMPLETED"===a.ok;d._options.onProgress(a.bytes_received,
a.bytes_expected,a);for(var f=0;f<a.uploads.length;f++)d._options.onUpload(a.uploads[f],a),d.uploads.push(a.uploads[f]);for(var h in a.results)for(d.results[h]=d.results[h]||[],f=0;f<a.results[h].length;f++)d._options.onResult(h,a.results[h][f],a),d.results[h].push(a.results[h][f]);b?(d.ended=!0,document.title=d.documentTitle,d._options.onCancel(a)):(d.renderProgress(a),e||!d._options.wait&&c?(d.ended=!0,document.title=d.documentTitle,a.uploads=d.uploads,a.results=d.results,d._options.onSuccess(a),
d._options.modal&&d.cancel(),d.submitForm()):(a=d.pollStarted-+new Date,d.timer=setTimeout(function(){d._poll()},a<d._options.interval?d._options.interval:a),d.lastPoll=+new Date))}},error:function(a,c){if(!d.ended)if(d.pollRetries++,d.pollRetries>d._options.pollConnectionRetries){document.title=d.documentTitle;d.ended=!0;var e={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+c,url:b};d.renderError(e);d._options.onError(e)}else setTimeout(function(){d._poll()},
350)}})}};a.prototype.stop=function(){document.title=this.documentTitle;this.ended=!0};a.prototype.cancel=function(){if(!this.ended){var a=this;this.$params&&this.$params.prependTo(this.$form);this.$fileClones.each(function(c){c=e(a.$files[c]).clone(!0);var b=e(this);c.insertAfter(b);b.remove()});clearTimeout(a.timer);this._poll("?method=delete");"Microsoft Internet Explorer"==navigator.appName&&this.$iframe[0].contentWindow.document.execCommand("Stop");setTimeout(function(){a.$iframe.remove()},500)}this._options.modal&&
(e.mask.close(),this.$modal.remove())};a.prototype.submitForm=function(){"multipart/form-data"===this.$form.attr("enctype")&&this.$form.removeAttr("enctype");null!==this.assembly&&e("<textarea/>").attr("name","transloadit").text(JSON.stringify(this.assembly)).prependTo(this.$form).hide();this._options.autoSubmit&&this.$form.unbind("submit.transloadit").submit()};a.prototype.showModal=function(){this.$modal=e('<div id="transloadit"><div class="content"><a href="#close" class="close">Cancel</a><p class="status"></p><div class="progress progress-striped active"><div class="bar"><span class="percent"></span></div></div><label>Starting upload ...</label><p class="error"></p><div class="error-details-toggle"><a href="#">Details</a></div><p class="error-details"></p></div></div>').appendTo("body");
e.extend(this.$modal,{$content:this.$modal.find(".content"),$close:this.$modal.find(".close"),$label:this.$modal.find("label"),$progress:this.$modal.find(".progress"),$percent:this.$modal.find(".progress .percent"),$progressBar:this.$modal.find(".progress .bar"),$error:this.$modal.find(".error"),$errorDetails:this.$modal.find(".error-details"),$errorDetailsToggle:this.$modal.find(".error-details-toggle")});var a=this;this.$modal.$close.click(function(){a.cancel()});this.$modal.$error.hide();this.$modal.$errorDetails.hide();
this.$modal.$errorDetailsToggle.hide();this.$modal.expose({api:!0,maskId:"transloadit_expose",opacity:0.9,loadSpeed:250,closeOnEsc:!1,closeOnClick:!1});this.$modal.$close.click(function(){a.cancel();return!1})};a.prototype.renderError=function(a){if(this._options.modal){this.$modal.$content.addClass("content-error");this.$modal.$progress.hide();this.$modal.$label.hide();var c=a.error+": "+a.message+"<br /><br />",c=c+(a.reason||"");if(-1===["CONNECTION_ERROR","BORED_INSTANCE_ERROR","ASSEMBLY_NOT_FOUND"].indexOf(a.error))this.$modal.$error.html(c).show();
else{this.$modal.$error.html("There was an internal error.<br />Please try your upload again.").show();var b=this,g=null;e.getJSON(f+"jsonip.com/",function(a){g=a.ip}).always(function(){var t={endpoint:a.url,instance:b.instance,assembly_id:b.assemblyId,ip:g,time:b.getUTCDatetime(),agent:navigator.userAgent,poll_retries:b.pollRetries,error:c};e.post(f+"status.transloadit.com/client_error",t);var v=[],k;for(k in t)v.push(k+": "+t[k]);t="If you would like our help to troubleshoot this, please email us this information:<br /><br />";
b.$modal.$errorDetails.hide().html(t+v.join("<br />"));b.$modal.$errorDetailsToggle.show().find("a").off("click").on("click",function(a){a.preventDefault();b.$modal.$errorDetails.toggle()})})}}};a.prototype.renderProgress=function(a){if(this._options.modal){var c=a.bytes_received/a.bytes_expected*100;100<c&&(c=0);var b=a.bytes_received-this.bytesReceivedBefore,e=+new Date-this.lastPoll,f=100===c?1E3:2*this._options.interval,g="Processing files";100!=c&&(g=(a.bytes_received/1024/1024).toFixed(2)+" MB / "+
(a.bytes_expected/1024/1024).toFixed(2)+" MB ("+(b/1024/(e/1E3)).toFixed(1)+" kB / sec)");this.$modal.$label.text(g);var k=parseInt(this.$modal.$progress.css("width"),10);this.bytesReceivedBefore=a.bytes_received;if(!(0>=b)){var q=this;this.$modal.$progressBar.stop().animate({width:c+"%"},{duration:f,easing:"linear",progress:function(a,c,b){a=(100*parseInt(q.$modal.$progressBar.css("width"),10)/k).toFixed(0);100<a&&(a=100);13<a&&q.$modal.$percent.text(a+"%")}})}}};a.prototype.includeCss=function(){!g&&
this._options.modal&&(g=!0,e('<link rel="stylesheet" type="text/css" href="'+this._options.assets+'css/transloadit2-v2.4.0.css" />').appendTo("head"))};a.prototype.getUTCDatetime=function(){var a=new Date,a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()),c=function(a){return 10>a?"0"+a:a},b=a.getTimezoneOffset(),e=(0<b?"-":"+")+c(parseInt(b/60,10));0!==b%60&&(e+=c(b%60));0===b&&(e="Z");return a.getFullYear()+"-"+c(a.getMonth()+1)+"-"+c(a.getDate())+
"T"+c(a.getHours())+":"+c(a.getMinutes())+":"+c(a.getSeconds())+e};a.prototype._genUuid=function(a,c,b){function e(a,c){var b=c||0,d=u;return d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]+d[a[b++]]}a=a||{};b=c&&b||0;var f=c||[],g=Array(16),k=function(){for(var a=0,b;16>a;a++)0===(a&3)&&(b=4294967296*Math.random()),g[a]=b>>>((a&3)<<3)&255;return g}(),q=[k[0]|1,k[1],k[2],k[3],k[4],k[5]];this._clockseq=
(k[6]<<8|k[7])&16383;for(var k=null!=a.clockseq?a.clockseq:this._clockseq,u=[],m=0;256>m;m++)u[m]=(m+256).toString(16).substr(1);var m=null!=a.msecs?a.msecs:(new Date).getTime(),n=null!=a.nsecs?a.nsecs:this._lastNSecs+1,l=m-this._lastMSecs+(n-this._lastNSecs)/1E4;0>l&&null==a.clockseq&&(k=k+1&16383);(0>l||m>this._lastMSecs)&&null==a.nsecs&&(n=0);if(1E4<=n)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");this._lastMSecs=m;this._lastNSecs=n;this._clockseq=k;m+=122192928E5;n=(1E4*(m&268435455)+
n)%4294967296;f[b++]=n>>>24&255;f[b++]=n>>>16&255;f[b++]=n>>>8&255;f[b++]=n&255;m=m/4294967296*1E4&268435455;f[b++]=m>>>8&255;f[b++]=m&255;f[b++]=m>>>24&15|16;f[b++]=m>>>16&255;f[b++]=k>>>8|128;f[b++]=k&255;a=a.node||q;for(q=0;6>q;q++)f[b+q]=a[q];return c?c:e(f)};a.prototype.options=function(a){if(0===arguments.length)return this._options;e.extend(this._options,a)};a.prototype.option=function(a,b){if(1==arguments.length)return this._options[a];this._options[a]=b}}(window.jQuery);
